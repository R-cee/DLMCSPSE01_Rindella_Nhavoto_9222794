{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./ManageEventsPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ManageEventsPage=()=>{const[events,setEvents]=useState([]);const[selectedEventId,setSelectedEventId]=useState(null);const[reason,setReason]=useState('');// For reject reason\nuseEffect(()=>{fetchEvents();},[]);const fetchEvents=async()=>{try{const response=await fetch('/api/admin/events');const data=await response.json();setEvents(data);}catch(error){console.error('Error fetching events:',error);}};const updateEventStatus=async(eventId,status)=>{const payload={status};// If the status is 'Rejected', include the reason\nif(status==='Rejected'&&reason){payload.reason=reason;}try{const response=await fetch(`/admin/event/update-status/${eventId}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(response.ok){fetchEvents();// Refresh the event list after update\n}else{const data=await response.json();console.error('Error updating event status:',data);alert(`Failed to update event status: ${data.error}`);}}catch(error){console.error('Error updating event status:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"manage-events-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Manage Events\"}),/*#__PURE__*/_jsx(\"div\",{className:\"event-cards-container\",children:events.map(event=>/*#__PURE__*/_jsxs(\"div\",{className:\"event-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:`/event_images/${event.event_poster}`,alt:event.event_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"event-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:event.event_name}),/*#__PURE__*/_jsx(\"p\",{children:event.event_description}),/*#__PURE__*/_jsx(\"p\",{children:event.event_location}),/*#__PURE__*/_jsx(\"p\",{children:event.event_date}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",event.event_status]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateEventStatus(event.event_id,'Approved'),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedEventId(event.event_id),children:\"Reject\"})]})]})]},event.event_id))}),selectedEventId&&/*#__PURE__*/_jsxs(\"div\",{className:\"reject-reason-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Reason for rejection:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:reason,onChange:e=>setReason(e.target.value),placeholder:\"State the reason for rejection\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{updateEventStatus(selectedEventId,'Rejected');setSelectedEventId(null);// Close the reason box after submitting\nsetReason('');},children:\"Submit Rejection\"})]})]});};export default ManageEventsPage;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","ManageEventsPage","events","setEvents","selectedEventId","setSelectedEventId","reason","setReason","fetchEvents","response","fetch","data","json","error","console","updateEventStatus","eventId","status","payload","method","headers","body","JSON","stringify","ok","alert","className","children","map","event","src","event_poster","alt","event_name","event_description","event_location","event_date","event_status","onClick","event_id","value","onChange","e","target","placeholder"],"sources":["C:/Users/Rindella Nhavoto/Desktop/ProjectsVSC/SWEproject/events-system-frontend/src/components/ManageEventsPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './ManageEventsPage.css';\r\n\r\nconst ManageEventsPage = () => {\r\n    const [events, setEvents] = useState([]);\r\n    const [selectedEventId, setSelectedEventId] = useState(null);\r\n    const [reason, setReason] = useState(''); // For reject reason\r\n\r\n    useEffect(() => {\r\n        fetchEvents();\r\n    }, []);\r\n\r\n    const fetchEvents = async () => {\r\n        try {\r\n            const response = await fetch('/api/admin/events');\r\n            const data = await response.json();\r\n            setEvents(data);\r\n        } catch (error) {\r\n            console.error('Error fetching events:', error);\r\n        }\r\n    };\r\n\r\n    const updateEventStatus = async (eventId, status) => {\r\n        const payload = { status };\r\n        \r\n        // If the status is 'Rejected', include the reason\r\n        if (status === 'Rejected' && reason) {\r\n            payload.reason = reason;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(`/admin/event/update-status/${eventId}`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify(payload),\r\n            });\r\n            if (response.ok) {\r\n                fetchEvents(); // Refresh the event list after update\r\n            } else {\r\n                const data = await response.json();\r\n                console.error('Error updating event status:', data);\r\n                alert(`Failed to update event status: ${data.error}`);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error updating event status:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"manage-events-page\">\r\n            <h2>Manage Events</h2>\r\n            <div className=\"event-cards-container\">\r\n                {events.map((event) => (\r\n                    <div key={event.event_id} className=\"event-card\">\r\n                        <img src={`/event_images/${event.event_poster}`} alt={event.event_name} />\r\n                        <div className=\"event-info\">\r\n                            <h3>{event.event_name}</h3>\r\n                            <p>{event.event_description}</p>\r\n                            <p>{event.event_location}</p>\r\n                            <p>{event.event_date}</p>\r\n                            <p>Status: {event.event_status}</p>\r\n                            <div className=\"action-buttons\">\r\n                                <button onClick={() => updateEventStatus(event.event_id, 'Approved')}>\r\n                                    Approve\r\n                                </button>\r\n                                <button onClick={() => setSelectedEventId(event.event_id)}>\r\n                                    Reject\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {selectedEventId && (\r\n                <div className=\"reject-reason-container\">\r\n                    <h3>Reason for rejection:</h3>\r\n                    <textarea\r\n                        value={reason}\r\n                        onChange={(e) => setReason(e.target.value)}\r\n                        placeholder=\"State the reason for rejection\"\r\n                    />\r\n                    <button\r\n                        onClick={() => {\r\n                            updateEventStatus(selectedEventId, 'Rejected');\r\n                            setSelectedEventId(null); // Close the reason box after submitting\r\n                            setReason('');\r\n                        }}\r\n                    >\r\n                        Submit Rejection\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ManageEventsPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}