{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./ManageEventsPage.css';import AdminHeader from'./AdminHeader';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ManageEventsPage=()=>{const[events,setEvents]=useState([]);const[selectedEventId,setSelectedEventId]=useState(null);const[reason,setReason]=useState('');const navigate=useNavigate();useEffect(()=>{fetchEvents();},[]);const fetchEvents=async()=>{try{const token=localStorage.getItem('jwt_token');const response=await fetch('/api/admin/events',{headers:{'Authorization':`Bearer ${token}`}});if(response.ok){const data=await response.json();setEvents(data);}else{console.error('Failed to fetch events');}}catch(error){console.error('Error fetching events:',error);}};const updateEventStatus=async(eventId,status)=>{const payload={status};if(status==='Rejected'&&reason){payload.reason=reason;}try{const token=localStorage.getItem('jwt_token');const response=await fetch(`/admin/event/update-status/${eventId}`,{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify(payload)});if(response.ok){fetchEvents();if(status==='Approved'){toast.success('Event approved successfully',{position:toast.POSITION.TOP_RIGHT});}else{toast.success(`Event rejected successfully - Reason: ${reason}`,{position:toast.POSITION.TOP_RIGHT});}setTimeout(()=>{navigate('/admin-dashboard');},2000);}else{const data=await response.json();console.error('Error updating event status:',data);alert(`Failed to update event status: ${data.error}`);}}catch(error){console.error('Error updating event status:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"manage-events-page\",children:[/*#__PURE__*/_jsx(AdminHeader,{}),/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Manage Events\"}),/*#__PURE__*/_jsx(\"div\",{className:\"event-cards-container\",children:events.map(event=>/*#__PURE__*/_jsxs(\"div\",{className:\"event-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:`/event_images/${event.event_poster}`,alt:event.event_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"event-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:event.event_name}),/*#__PURE__*/_jsx(\"p\",{children:event.event_description}),/*#__PURE__*/_jsx(\"p\",{children:event.event_location}),/*#__PURE__*/_jsx(\"p\",{children:event.event_date}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",event.event_status]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateEventStatus(event.event_id,'Approved'),children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedEventId(event.event_id),children:\"Reject\"})]})]})]},event.event_id))}),selectedEventId&&/*#__PURE__*/_jsxs(\"div\",{className:\"reject-reason-container\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Reason for rejection:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:reason,onChange:e=>setReason(e.target.value),placeholder:\"State the reason for rejection\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{updateEventStatus(selectedEventId,'Rejected');setSelectedEventId(null);setReason('');},children:\"Submit Rejection\"})]})]});};export default ManageEventsPage;","map":{"version":3,"names":["React","useState","useEffect","AdminHeader","ToastContainer","toast","useNavigate","jsx","_jsx","jsxs","_jsxs","ManageEventsPage","events","setEvents","selectedEventId","setSelectedEventId","reason","setReason","navigate","fetchEvents","token","localStorage","getItem","response","fetch","headers","ok","data","json","console","error","updateEventStatus","eventId","status","payload","method","body","JSON","stringify","success","position","POSITION","TOP_RIGHT","setTimeout","alert","className","children","map","event","src","event_poster","alt","event_name","event_description","event_location","event_date","event_status","onClick","event_id","value","onChange","e","target","placeholder"],"sources":["C:/Users/Rindella Nhavoto/Desktop/ProjectsVSC/SWEproject/EventsGit/DLMCSPSE01_Rindella_Nhavoto_9222794/events-system-frontend/src/components/ManageEventsPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './ManageEventsPage.css';\r\nimport AdminHeader from './AdminHeader';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst ManageEventsPage = () => {\r\n    const [events, setEvents] = useState([]);\r\n    const [selectedEventId, setSelectedEventId] = useState(null);\r\n    const [reason, setReason] = useState('');\r\n    const navigate = useNavigate(); \r\n\r\n    useEffect(() => {\r\n        fetchEvents();\r\n    }, []);\r\n\r\n    const fetchEvents = async () => {\r\n        try {\r\n            const token = localStorage.getItem('jwt_token'); \r\n            const response = await fetch('/api/admin/events', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                },\r\n            });\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setEvents(data);\r\n            } else {\r\n                console.error('Failed to fetch events');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching events:', error);\r\n        }\r\n    };\r\n\r\n    const updateEventStatus = async (eventId, status) => {\r\n        const payload = { status };\r\n        \r\n        if (status === 'Rejected' && reason) {\r\n            payload.reason = reason;\r\n        }\r\n\r\n        try {\r\n            const token = localStorage.getItem('jwt_token'); \r\n            const response = await fetch(`/admin/event/update-status/${eventId}`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`,\r\n                },\r\n                body: JSON.stringify(payload),\r\n            });\r\n            if (response.ok) {\r\n                fetchEvents();\r\n                if (status === 'Approved') {\r\n                    toast.success('Event approved successfully', {\r\n                        position: toast.POSITION.TOP_RIGHT,\r\n                    });\r\n                } else {\r\n                    toast.success(`Event rejected successfully - Reason: ${reason}`, {\r\n                        position: toast.POSITION.TOP_RIGHT,\r\n                    });\r\n                }\r\n                setTimeout(() => {\r\n                    navigate('/admin-dashboard'); \r\n                }, 2000);\r\n            } else {\r\n                const data = await response.json();\r\n                console.error('Error updating event status:', data);\r\n                alert(`Failed to update event status: ${data.error}`);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error updating event status:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"manage-events-page\">\r\n            <AdminHeader />\r\n            <ToastContainer />\r\n            <h2>Manage Events</h2>\r\n            <div className=\"event-cards-container\">\r\n                {events.map((event) => (\r\n                    <div key={event.event_id} className=\"event-card\">\r\n                        <img src={`/event_images/${event.event_poster}`} alt={event.event_name} />\r\n                        <div className=\"event-info\">\r\n                            <h3>{event.event_name}</h3>\r\n                            <p>{event.event_description}</p>\r\n                            <p>{event.event_location}</p>\r\n                            <p>{event.event_date}</p>\r\n                            <p>Status: {event.event_status}</p>\r\n                            <div className=\"action-buttons\">\r\n                                <button onClick={() => updateEventStatus(event.event_id, 'Approved')}>\r\n                                    Approve\r\n                                </button>\r\n                                <button onClick={() => setSelectedEventId(event.event_id)}>\r\n                                    Reject\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {selectedEventId && (\r\n                <div className=\"reject-reason-container\">\r\n                    <h3>Reason for rejection:</h3>\r\n                    <textarea\r\n                        value={reason}\r\n                        onChange={(e) => setReason(e.target.value)}\r\n                        placeholder=\"State the reason for rejection\"\r\n                    />\r\n                    <button\r\n                        onClick={() => {\r\n                            updateEventStatus(selectedEventId, 'Rejected');\r\n                            setSelectedEventId(null); \r\n                            setReason('');\r\n                        }}\r\n                    >\r\n                        Submit Rejection\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ManageEventsPage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,wBAAwB,CAC/B,MAAO,CAAAC,WAAW,KAAM,eAAe,CACvC,OAASC,cAAc,CAAEC,KAAK,KAAQ,gBAAgB,CACtD,MAAO,uCAAuC,CAC9C,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,gBAAgB,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACa,eAAe,CAAEC,kBAAkB,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAACe,MAAM,CAAEC,SAAS,CAAC,CAAGhB,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAAAiB,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAE9BJ,SAAS,CAAC,IAAM,CACZiB,WAAW,CAAC,CAAC,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAA,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACA,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAC/C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,mBAAmB,CAAE,CAC9CC,OAAO,CAAE,CACL,eAAe,CAAE,UAAUL,KAAK,EACpC,CACJ,CAAC,CAAC,CACF,GAAIG,QAAQ,CAACG,EAAE,CAAE,CACb,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAClCf,SAAS,CAACc,IAAI,CAAC,CACnB,CAAC,IAAM,CACHE,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAC,CAC3C,CACJ,CAAE,MAAOA,KAAK,CAAE,CACZD,OAAO,CAACC,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAClD,CACJ,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAG,KAAAA,CAAOC,OAAO,CAAEC,MAAM,GAAK,CACjD,KAAM,CAAAC,OAAO,CAAG,CAAED,MAAO,CAAC,CAE1B,GAAIA,MAAM,GAAK,UAAU,EAAIjB,MAAM,CAAE,CACjCkB,OAAO,CAAClB,MAAM,CAAGA,MAAM,CAC3B,CAEA,GAAI,CACA,KAAM,CAAAI,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAC/C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,8BAA8BQ,OAAO,EAAE,CAAE,CAClEG,MAAM,CAAE,MAAM,CACdV,OAAO,CAAE,CACL,cAAc,CAAE,kBAAkB,CAClC,eAAe,CAAE,UAAUL,KAAK,EACpC,CAAC,CACDgB,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO,CAChC,CAAC,CAAC,CACF,GAAIX,QAAQ,CAACG,EAAE,CAAE,CACbP,WAAW,CAAC,CAAC,CACb,GAAIc,MAAM,GAAK,UAAU,CAAE,CACvB5B,KAAK,CAACkC,OAAO,CAAC,6BAA6B,CAAE,CACzCC,QAAQ,CAAEnC,KAAK,CAACoC,QAAQ,CAACC,SAC7B,CAAC,CAAC,CACN,CAAC,IAAM,CACHrC,KAAK,CAACkC,OAAO,CAAC,yCAAyCvB,MAAM,EAAE,CAAE,CAC7DwB,QAAQ,CAAEnC,KAAK,CAACoC,QAAQ,CAACC,SAC7B,CAAC,CAAC,CACN,CACAC,UAAU,CAAC,IAAM,CACbzB,QAAQ,CAAC,kBAAkB,CAAC,CAChC,CAAC,CAAE,IAAI,CAAC,CACZ,CAAC,IAAM,CACH,KAAM,CAAAS,IAAI,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAClCC,OAAO,CAACC,KAAK,CAAC,8BAA8B,CAAEH,IAAI,CAAC,CACnDiB,KAAK,CAAC,kCAAkCjB,IAAI,CAACG,KAAK,EAAE,CAAC,CACzD,CACJ,CAAE,MAAOA,KAAK,CAAE,CACZD,OAAO,CAACC,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,CACxD,CACJ,CAAC,CAED,mBACIpB,KAAA,QAAKmC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eAC/BtC,IAAA,CAACL,WAAW,GAAE,CAAC,cACfK,IAAA,CAACJ,cAAc,GAAE,CAAC,cAClBI,IAAA,OAAAsC,QAAA,CAAI,eAAa,CAAI,CAAC,cACtBtC,IAAA,QAAKqC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CACjClC,MAAM,CAACmC,GAAG,CAAEC,KAAK,eACdtC,KAAA,QAA0BmC,SAAS,CAAC,YAAY,CAAAC,QAAA,eAC5CtC,IAAA,QAAKyC,GAAG,CAAE,iBAAiBD,KAAK,CAACE,YAAY,EAAG,CAACC,GAAG,CAAEH,KAAK,CAACI,UAAW,CAAE,CAAC,cAC1E1C,KAAA,QAAKmC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACvBtC,IAAA,OAAAsC,QAAA,CAAKE,KAAK,CAACI,UAAU,CAAK,CAAC,cAC3B5C,IAAA,MAAAsC,QAAA,CAAIE,KAAK,CAACK,iBAAiB,CAAI,CAAC,cAChC7C,IAAA,MAAAsC,QAAA,CAAIE,KAAK,CAACM,cAAc,CAAI,CAAC,cAC7B9C,IAAA,MAAAsC,QAAA,CAAIE,KAAK,CAACO,UAAU,CAAI,CAAC,cACzB7C,KAAA,MAAAoC,QAAA,EAAG,UAAQ,CAACE,KAAK,CAACQ,YAAY,EAAI,CAAC,cACnC9C,KAAA,QAAKmC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC3BtC,IAAA,WAAQiD,OAAO,CAAEA,CAAA,GAAM1B,iBAAiB,CAACiB,KAAK,CAACU,QAAQ,CAAE,UAAU,CAAE,CAAAZ,QAAA,CAAC,SAEtE,CAAQ,CAAC,cACTtC,IAAA,WAAQiD,OAAO,CAAEA,CAAA,GAAM1C,kBAAkB,CAACiC,KAAK,CAACU,QAAQ,CAAE,CAAAZ,QAAA,CAAC,QAE3D,CAAQ,CAAC,EACR,CAAC,EACL,CAAC,GAhBAE,KAAK,CAACU,QAiBX,CACR,CAAC,CACD,CAAC,CAEL5C,eAAe,eACZJ,KAAA,QAAKmC,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACpCtC,IAAA,OAAAsC,QAAA,CAAI,uBAAqB,CAAI,CAAC,cAC9BtC,IAAA,aACImD,KAAK,CAAE3C,MAAO,CACd4C,QAAQ,CAAGC,CAAC,EAAK5C,SAAS,CAAC4C,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CAC3CI,WAAW,CAAC,gCAAgC,CAC/C,CAAC,cACFvD,IAAA,WACIiD,OAAO,CAAEA,CAAA,GAAM,CACX1B,iBAAiB,CAACjB,eAAe,CAAE,UAAU,CAAC,CAC9CC,kBAAkB,CAAC,IAAI,CAAC,CACxBE,SAAS,CAAC,EAAE,CAAC,CACjB,CAAE,CAAA6B,QAAA,CACL,kBAED,CAAQ,CAAC,EACR,CACR,EACA,CAAC,CAEd,CAAC,CAED,cAAe,CAAAnC,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}