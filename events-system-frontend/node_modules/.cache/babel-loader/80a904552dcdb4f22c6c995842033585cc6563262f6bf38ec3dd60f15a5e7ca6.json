{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./Notifications.css';import HostHeader from'./HostHeader';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Notifications=()=>{const[notifications,setNotifications]=useState([]);const[error,setError]=useState(null);const[userRole,setUserRole]=useState('');useEffect(()=>{const fetchUserRole=()=>{const token=localStorage.getItem('jwt_token');const user=JSON.parse(localStorage.getItem('user'));if(user&&user.role){setUserRole(user.role);}};fetchUserRole();fetchNotifications();},[]);const fetchNotifications=async()=>{try{const token=localStorage.getItem('jwt_token');const response=await fetch('/notifications',{headers:{'Authorization':`Bearer ${token}`}});if(response.ok){const data=await response.json();setNotifications(data.notifications);markNotificationsAsRead();}else{setError('Failed to fetch notifications');}}catch(error){setError('Error fetching notifications');}};const markNotificationsAsRead=async()=>{try{const token=localStorage.getItem('jwt_token');await fetch('/notifications/mark-as-read',{method:'POST',headers:{'Authorization':`Bearer ${token}`}});}catch(error){setError('Failed to mark notifications as read');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"notifications-container\",children:[userRole==='EventHost'&&/*#__PURE__*/_jsx(HostHeader,{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Notifications\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),/*#__PURE__*/_jsxs(\"table\",{className:\"notifications-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Message\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:notifications.length>0?notifications.map((notification,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:notification.is_read?\"notification-item read\":\"notification-item unread\",children:[/*#__PURE__*/_jsx(\"td\",{children:notification.message}),/*#__PURE__*/_jsx(\"td\",{children:new Date(notification.created_at).toLocaleString()})]},index)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",children:\"No notifications available.\"})})})]})]});};export default Notifications;","map":{"version":3,"names":["React","useState","useEffect","HostHeader","jsx","_jsx","jsxs","_jsxs","Notifications","notifications","setNotifications","error","setError","userRole","setUserRole","fetchUserRole","token","localStorage","getItem","user","JSON","parse","role","fetchNotifications","response","fetch","headers","ok","data","json","markNotificationsAsRead","method","className","children","length","map","notification","index","is_read","message","Date","created_at","toLocaleString","colSpan"],"sources":["C:/Users/Rindella Nhavoto/Desktop/ProjectsVSC/SWEproject/EventsGit/DLMCSPSE01_Rindella_Nhavoto_9222794/events-system-frontend/src/components/Notification.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './Notifications.css';\r\nimport HostHeader from './HostHeader';\r\n\r\nconst Notifications = () => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [error, setError] = useState(null);\r\n  const [userRole, setUserRole] = useState('');\r\n\r\n  useEffect(() => {\r\n    const fetchUserRole = () => {\r\n      const token = localStorage.getItem('jwt_token');\r\n\r\n      const user = JSON.parse(localStorage.getItem('user')); \r\n      if (user && user.role) {\r\n        setUserRole(user.role); \r\n      }\r\n    };\r\n    \r\n    fetchUserRole();\r\n    fetchNotifications();\r\n  }, []);\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      const token = localStorage.getItem('jwt_token');\r\n      const response = await fetch('/notifications', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setNotifications(data.notifications);\r\n        markNotificationsAsRead(); \r\n      } else {\r\n        setError('Failed to fetch notifications');\r\n      }\r\n    } catch (error) {\r\n      setError('Error fetching notifications');\r\n    }\r\n  };\r\n\r\n  const markNotificationsAsRead = async () => {\r\n    try {\r\n      const token = localStorage.getItem('jwt_token');\r\n      await fetch('/notifications/mark-as-read', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n    } catch (error) {\r\n      setError('Failed to mark notifications as read');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"notifications-container\">\r\n      {userRole === 'EventHost' && <HostHeader />}\r\n      <h2>Notifications</h2>\r\n      {error && <p className=\"error\">{error}</p>}\r\n      <table className=\"notifications-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Message</th>\r\n            <th>Date</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {notifications.length > 0 ? (\r\n            notifications.map((notification, index) => (\r\n              <tr \r\n                key={index} \r\n                className={notification.is_read ? \"notification-item read\" : \"notification-item unread\"}\r\n              >\r\n                <td>{notification.message}</td>\r\n                <td>{new Date(notification.created_at).toLocaleString()}</td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan=\"3\">No notifications available.</td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Notifications;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}